<!DOCTYPE HTML>
<html>
<head>
    <!-- Load jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    
    <!-- Load Highcharts -->
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/boxplot.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
    
    <!-- Include PapaParse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <div id="container" style="width:100%; height:400px;"></div>

    <script>
    // Replace with your actual CSV URL or file path
    var url = 'auto-mpg.csv';  // Example: 'path/to/your/auto-mpg.csv'
    
    $.get(url, function(csv) {
        
        // Parse the CSV data using PapaParse
        Papa.parse(csv, {
            header: true,  // Treat the first row as headers
            dynamicTyping: true,  // Automatically convert data types
            complete: function(results) {
                
                // Log parsed CSV data to debug
                console.log(results.data);  // Check if data is parsed correctly
                
                // Extract the model year and weight columns
                var dataPoints = results.data
                    .filter(function(row) {
                        // Filter out rows where 'model year' or 'weight' are invalid or missing
                        return row['model year'] && !isNaN(row['weight']); // Ensure non-null and numeric
                    })
                    .map(function(row) {
                        return {
                            x: row['model year'],  // Assuming 'model year' is the column name
                            y: row['weight']       // 'weight' is the column name for car weights
                        };
                    });

                // Log the processed data points for debugging
                console.log(dataPoints);  // Check the data points being passed to Highcharts
                
                if (dataPoints.length > 0) {
                    // Create the Highcharts scatter plot if data exists
                    $('#container').highcharts({
                        chart: {
                            type: 'scatter'
                        },

                        title: {
                            text: 'Scatter Plot of Car Weights by Model Year'
                        },

                        xAxis: {
                            title: {
                                text: 'Model Year'
                            },
                            min: Math.min(...dataPoints.map(p => p.x)), // Set x-axis min and max for better visualization
                            max: Math.max(...dataPoints.map(p => p.x))
                        },

                        yAxis: {
                            title: {
                                text: 'Weight'
                            },
                            min: Math.min(...dataPoints.map(p => p.y)),  // Set y-axis min and max
                            max: Math.max(...dataPoints.map(p => p.y))
                        },

                        series: [{
                            name: 'Car Weights',
                            data: dataPoints,
                            tooltip: {
                                pointFormat: '<b>Weight:</b> {point.y}<br>' +
                                             '<b>Model Year:</b> {point.x}'
                            }
                        }]
                    });
                } else {
                    console.error('No valid data points found!');
                }
            },
            error: function(error) {
                console.error('Error parsing CSV:', error);
            }
        });
    });
    </script>
</body>
</html>

